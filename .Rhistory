points(centers[i,],type='l',col=i)
}
centers
plot(centers[1,],type='l',ylim = range(-0.1,0.1),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
windows(1000,1000)
#p = par(mfrow=c(5,1))
plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
n = 6
windows(1000,1000)
#p = par(mfrow=c(5,1))
plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
delta
Delt(data$Close)
votile = as.data.frame(Delt(data$Close))
colnames(votile) = 'change'
votile$time = time
votile$day = as.character(as.Date(rownames(votile)))
times = get_min_series()
votile = subset(votile,time %in% times)
xx_dcast = dcast(votile,day ~ time,value.var='change')
xx = xx_dcast[,2:ncol(xx_dcast)]
head(xx)
xx = na.omit(xx)
fit = kmeans(xx,n,iter.max = 100)
centers = fit$centers
centers
windows(1000,1000)
#p = par(mfrow=c(5,1))
plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
time
votile
votile[time %in% times,]
votile[time %in% c('09:00:00'),]
data_open = data[time %in% c('09:00:00')]
head(data_open)
data_open_votile = (data_open$Close - data_Open$Open)/data_Open$Open
data_open = data[time %in% c('09:00:00')]
data_open_votile = (data_open$Close - data_Open$Open)/data_Open$Open
data_open_votile = (data_open$Close - data_open$Open)/data_open$Open
votile = as.data.frame(Delt(data$Close))
votile[time %in% c('09:00:00')]
data_open = data[time %in% c('09:00:00'),]
data_open_votile = (data_open$Close - data_open$Open)/data_open$Open
votile = as.data.frame(Delt(data$Close))
votile[time %in% c('09:00:00'),]
votile[time %in% c('09:00:00'),] = data_open_votile
colnames(votile) = 'change'
votile$time = time
votile$day = as.character(as.Date(rownames(votile)))
votile = subset(votile,time %in% times)
xx_dcast = dcast(votile,day ~ time,value.var='change')
xx = xx_dcast[,2:ncol(xx_dcast)]
xx = na.omit(xx)
fit = kmeans(xx,n,iter.max = 100)
centers = fit$centers
centers
centers_unscaled = unscale(centers,xx_scaled)
windows(1000,1000)
#p = par(mfrow=c(5,1))
plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
max(centers)
min(centers)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
windows(1000,1000)
#p = par(mfrow=c(5,1))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
plot(centers[1,])
plot(centers[2,])
plot(centers[3,])
plot(centers[4,])
plot(centers[5,])
plot(centers[6,])
head(xx)
head(xx_dcast)
head(data)
(1201 - 1230) / 1230
3 / 1201
plot(xx[1,])
plot(as.numeric(xx[1,]))
plot(Cl(data[1,]))
plot(Cl(data[index(data)[1]]))
data[index(data)[1]]
plot(Cl(data['2004-09-22']))
plot(centers[5,])
n = 10
fit = kmeans(xx,n,iter.max = 100)
centers = fit$centers
plot(centers[1,])
plot(centers[2,])
plot(centers[3,])
plot(centers[3,])
plot(centers[4,])
plot(centers[4,],type = 'l')
labels = fit$cluster
labels
table(labels)
plot(centers[1,],type = 'l')
plot(centers[2,],type = 'l')
plot(centers[3,],type = 'l')
plot(centers[4,],type = 'l')
plot(centers[9,],type = 'l')
windows(1000,1000)
p = par(mfrow=c(5,2))
plot(centers[1,],type = 'l')
plot(centers[2,],type = 'l')
plot(centers[3,],type = 'l')
index = which(labels == 1)
index
options(digits = 10)
centers
options(digits = 100)
options(digits = 22)
centers
options(scipen =200)
centers
index
index[1,]
index[1]
xx[9,]
xx_dcast[9,]
data['2004-10-11']$Close
plot(as.numeric(data['2004-10-11']$Close))
table(labels)
plot(centers[1,])
head(lables)
head(labels)
table(labels)
index
n = index[5]
m = index[5]
m
date = xx_dcast[m,]
date
date = xx_dcast[m,]$day
plot(data[date]$Close)
plot(as.numeric(data[date]$Close))
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
points(centers[1,],type='l',col = 'green')
p = par(mfrow=c(2,1))
m = index[5]
date = xx_dcast[m,]$day
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
points(centers[1,],type='l',col = 'green')
par(p)
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
p = par(mfrow=c(2,1))
m = index[5]
date = xx_dcast[m,]$day
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
plot(centers[1,],type='l',col = 'green')
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
plot(centers[1,],type='l',col = 'green',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
par(p)
p = par(mfrow=c(2,1))
m = index[5]
date = xx_dcast[m,]$day
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
plot(centers[1,],type='l',col = 'green',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
par(p)
cluster_n = 1
index = which(labels == cluster_n)
p = par(mfrow=c(2,1))
m = index[10]
date = xx_dcast[m,]$day
plot(as.numeric(data[date]$Close),type = 'l',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
plot(centers[1,],type='l',col = 'green',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
par(p)
table(labels)
plot(centers[cluster_n,],type='l',col = 'green',xlab='',xaxt = 'n')
axis(1, 1:length(centers[1,]),names(centers[1,]))
cluster_n = 3
plot(centers[cluster_n,],type='l',col = 'green',xlab='',xaxt = 'n')
predict(fit,centers[1])
?knn
28
require('shiny')
require('stringr')
require('DT')
sourceDir <- function(path, trace = TRUE, ...) {
for (nm in list.files(path, pattern = "[.][RrSsQq]$")) {
if(trace) cat(nm,":")
source(file.path(path, nm), ...)
if(trace) cat("\n")
}
}
currentwd = getwd()
setwd("d:/tradingSystem/Rcode/code/everydaystudy")
sourceDir("helper",encoding='utf-8')
runApp("web")
source('src/config/include.R',encoding='utf-8')
dbname = 'china_future_ods_m'
tbname = 'dlcmi'
data = getTableData(dbname,tbname)
data = xts(data[,c('Open','High','Low','Close','Vol','Oi')],order.by=as.POSIXct(data$datetime,format='%Y-%m-%d %H:%M:%S'))
data = to_minutes(data,15)
time = as.character(index(data))
time = substr(time,12,19)
times = get_min_series()
require('DTW')
require('dtw')
?dtw
dtw
where(is.matrix)
??where
?search
a = c(1,5)
b = c(1,5)
a*b
sum(a*b)
sum(a*b) / 4
?cos
acos(6.5)
a = c(21,23,22,25,26)
b = a * 100
ab
Delt(a)
source('src/config/include.R',encoding='utf-8')
Delt(a)
Delt(b)
a
b
b = a + 2000
Delt(b)
Delt(a)
diff(a)
diff(b)
cumsum(diff(a))
log0.3
log(0.3)
a
b
Delt(b)
Delt(a)
Delt(b) * 10
scale(a)
scale(b)
a
b
a
x = 1:5
lm(a~x)
lm(a~x)
f = lm(a~x)
f$coefficients
f = lm(a*10~x)
f$coefficients
ma = Delt(a)
mb = Delt(b)
ma
mb
ma = Delt(diff(a))
mb = Delt(diff(b))
ma
mb
ma
a
diff(a)
y
a
x
fit = lm(a~x)
predict(fit,6)
predict(fit,data.frame(6))
?lm
predict(fit,data.frame(x=6))
pa = diff(a)
lm(pa~y)
y
lm(pa~x)
pa
lm(pa~1:4)
x1 = 1:4
lm(pa~x1)
fit1 = lm(pa~x1)
predict(fit1)
pa
x1
x
predict(fit1,data.frame(x1=5))
x
a
2318-15
source('src/config/include.R',encoding='utf-8')
dbname = 'china_future_ods_m'
tbname = 'dlcmi'
data = getTableData(dbname,tbname)
data = xts(data[,c('Open','High','Low','Close','Vol','Oi')],order.by=as.POSIXct(data$datetime,format='%Y-%m-%d %H:%M:%S'))
data = to_minutes(data,15)
time = as.character(index(data))
time = substr(time,12,19)
times = get_min_series()
data_open = data[time %in% c('09:00:00'),]
data_open_votile = (data_open$Close - data_open$Open)/data_open$Open
votile = as.data.frame(Delt(data$Close))
votile[time %in% c('09:00:00'),] = data_open_votile
xx = na.omit(xx)
colnames(votile) = 'change'
votile$time = time
votile$day = as.character(as.Date(rownames(votile)))
votile = subset(votile,time %in% times)
xx_dcast = dcast(votile,day ~ time,value.var='change')
xx = xx_dcast[,2:ncol(xx_dcast)]
xx = na.omit(xx)
n = 10
fit = kmeans(xx,n,iter.max = 100)
centers = fit$centers
labels = fit$cluster
centers_unscaled = unscale(centers,xx_scaled)
windows(1000,1000)
p = par(mfrow=c(5,2))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
windows(1000,1000)
p = par(mfrow=c(5,2))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
windows(1000,1000)
#p = par(mfrow=c(5,2))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
require('shiny')
require('stringr')
require('DT')
sourceDir <- function(path, trace = TRUE, ...) {
for (nm in list.files(path, pattern = "[.][RrSsQq]$")) {
if(trace) cat(nm,":")
source(file.path(path, nm), ...)
if(trace) cat("\n")
}
}
currentwd = getwd()
setwd("d:/tradingSystem/Rcode/code/everydaystudy")
sourceDir("helper",encoding='utf-8')
runApp("web")
source('src/config/include.R',encoding='utf-8')
dbname = 'china_future_ods_m'
tbname = 'dlcmi'
data = getTableData(dbname,tbname)
data = xts(data[,c('Open','High','Low','Close','Vol','Oi')],order.by=as.POSIXct(data$datetime,format='%Y-%m-%d %H:%M:%S'))
data = to_minutes(data,15)
time = as.character(index(data))
time = substr(time,12,19)
times = get_min_series()
data_open = data[time %in% c('09:00:00'),]
data_open_votile = (data_open$Close - data_open$Open)/data_open$Open
votile = as.data.frame(Delt(data$Close))
votile[time %in% c('09:00:00'),] = data_open_votile
?lm
colnames(votile) = 'change'
votile$time = time
votile$day = as.character(as.Date(rownames(votile)))
votile = subset(votile,time %in% times)
xx_dcast = dcast(votile,day ~ time,value.var='change')
xx = xx_dcast[,2:ncol(xx_dcast)]
xx = na.omit(xx)
n = 10
fit = kmeans(xx,n,iter.max = 100)
centers = fit$centers
labels = fit$cluster
windows(1000,1000)
#p = par(mfrow=c(5,2))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
windows(1000,1000)
#p = par(mfrow=c(5,2))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
windows(1000,1000)
#p = par(mfrow=c(5,2))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
centers
plot(as.numeric(centers[1,]))
?scan
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))}
scan()
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))}
scan()
?scan
stdin()
scan(stdin())
scan(stdin())
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))}
scan(stdin())
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))}
scan(stdin())
readChar()
readChar(stdin())
readChar(stdin(),1)
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))}
tmp = scan()
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))}
tmp = scan()
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
tmp = scan()
}
windows(1000,1000)
#p = par(mfrow=c(5,2))
#plot(centers[1,],type='l',ylim = range(-0.01,0.01),xlab='',xaxt = 'n') #ylim = range(-6,6)
plot(centers[1,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n') #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
for( i in 2:n)
{
points(centers[i,],type='l',col=i)
}
for( i in 1:n)
{
plot(centers[i,],type='l',ylim = range(max(centers),min(centers)),xlab='',xaxt = 'n',col=i) #ylim = range(-6,6)
axis(1, 1:length(centers[1,]),names(centers[1,]))
tmp = scan()
}
10
knn
centers[o]
centers
k = 5
sapply(centers,min)
